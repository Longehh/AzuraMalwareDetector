package net.azurax.malware.provider;

import net.azurax.malware.api.provider.ICheckProvider;
import net.azurax.malware.api.check.IMalwareCheck;
import net.azurax.malware.checks.ExfilterationCheck;
import net.azurax.malware.checks.HostflowCheck;
import net.azurax.malware.checks.SystemCheck;

import java.util.ArrayList;
import java.util.List;

public class CheckProvider implements ICheckProvider {
    private final List<IMalwareCheck> malwareChecks = new ArrayList<IMalwareCheck>(){{
        add(new HostflowCheck());
        add(new ExfilterationCheck());
        add(new SystemCheck());
    }};

    public IMalwareCheck getCheckByName(String name) {
        for(IMalwareCheck check : malwareChecks) {
            if(check.getCheckName().equalsIgnoreCase(name)) {
                return check;
            }
        }
        return null;
    }

    public List<IMalwareCheck> getMalwareChecks() {
        return malwareChecks;
    }
}
