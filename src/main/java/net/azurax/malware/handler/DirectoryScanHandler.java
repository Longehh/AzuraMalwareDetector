package net.azurax.malware.handler;

import net.azurax.malware.api.check.IMalwareCheck;
import net.azurax.malware.api.handler.IScan;
import net.azurax.malware.ui.ScannerDisplay;

import java.io.File;
import java.util.List;
import java.util.Objects;

public class DirectoryScanHandler implements IScan {
    private final ScannerDisplay display;
    private final List<IMalwareCheck> selectedChecks;
    private final File directory;

    public DirectoryScanHandler(ScannerDisplay display, List<IMalwareCheck> selectedChecks, File directory) {
        this.display = display;
        this.selectedChecks = selectedChecks;
        this.directory = directory;
    }

    @Override
    public void startScan() {
        display.getResultArea().setText("Scanning Directory: " + directory.getAbsolutePath() + "\n");
        for (File file : Objects.requireNonNull(directory.listFiles())) {
            if (file.isDirectory() || !file.getName().contains(".jar")) {
                continue;
            }
            IScan fileScanHandler = new FileScanHandler(display, selectedChecks, file, true);
            fileScanHandler.startScan();
        }
    }
}
